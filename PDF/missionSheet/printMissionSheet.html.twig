<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//FR"
        "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <title>PDF Paprec Mission Sheet</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <style type="text/css">
        html,
        body {
            margin: 0;
            padding: 0;
            font-family: "Red Hat Display", sans-serif;
            font-weight: 500;
            font-size: 17px;
            color: #4a4a4a;
        }

        * {
            box-sizing: border-box;
            -webkit-box-sizing: border-box;
        }

        h1 {
            color: #004a8e;
            font-size: 20px;
            font-weight: 900;
            margin: 0;
            width: 70%;
        }

        h2 {
            font-size: 17px;
            font-weight: bold;
            margin-bottom: 15px;
            margin-top: 20px;
            border-bottom: 1px solid #4a4a4a;
            padding-bottom: 5px;
        }

        p {
            margin: 5px 0;
            padding-bottom: 15px;
        }

        hr {
            border: 1px dashed #d8d8d8;
            width: 200px;
            height: 1px;
            margin: 8px 20px 0 20px;
        }

        .bold {
            font-weight: bold;
        }

        .text-left {
            text-align: left;
        }

        .text-right {
            text-align: right;
        }

        .mission__container {
            position: relative;
        }

        /* FLEXBOX */

        .flex {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: -moz-box;
            /*display: box;*/
            display: flex;
        }

        .align-item-center {
            -webkit-box-align: center;
            -moz-box-align: center;
            -ms-flex-align: center;
            -webkit-align-items: center;
            box-align: center;
            align-items: center;
        }

        .align-item-end {
            -webkit-box-align: end;
            -moz-box-align: end;
            -ms-flex-align: end;
            -webkit-align-items: end;
            box-align: end;
            align-items: flex-end;
        }

        .justify-center {
            -webkit-box-pack: center;
            box-pack: center;
            justify-content: center;
        }

        .justify-end {
            -webkit-box-pack: end;
            box-pack: end;
            justify-content: flex-end;
        }

        .space-between {
            -webkit-box-pack: justify;
            box-pack: justify;
            justify-content: space-between;
        }

        .w50 {
            width: 50%;
        }

        .mb-14 {
            margin-bottom: 14px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .mb-30 {
            margin-bottom: 30px;
        }

        .mb-40 {
            margin-bottom: 40px;
        }

        /***** PAGE OFFRE *****/

        /*Title*/

        .mission__title {
            border-bottom: 2px solid #004a8e;
        }

        .mission__title__ref {
            margin: 0;
            padding: 2px 5px 0 5px;
            color: #f00f0f;
            font-size: 20px;
            text-transform: uppercase;
            font-weight: 900;
        }

        .mission__title__date {
            color: #004a8e;
            margin: 0;
            padding: 2px 5px 0 5px;
            font-size: 20px;
            text-transform: uppercase;
            font-weight: 900;
        }

        /*content*/

        .mission__content {
            padding: 0 0 30px 0;
        }

        .mission__ref-items > div:first-child {
            width: 50%;
        }

        .mission__ref-items > div:last-child {
            width: 50%;
            margin-left: 70px;
            padding-right: 15px;
        }

        table {
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
            margin-bottom: 20px;
        }

        table p {
            margin: 0;
        }

        table td, table th {
            /*font-size: 13px;*/
            overflow: hidden;
            word-break: normal;
            text-align: center;
            border: 1px solid;
            border-right: 0px;
            border-bottom: 0px;
            height: 22px;
        }

        table th {
            padding: 5px 10px;
            vertical-align: top;
        }

        table td {
            padding: 2px 5px;
        }

        table span {
            font-weight: normal;
        }

        table tr th:last-child {
            border-right: 1px solid;
        }

        table tr td:last-child {
            border-right: 1px solid;
        }

        table.creation thead tr:last-child th:last-child {
            border-bottom: 1px solid;
        }

        table tbody tr:last-child td {
            border-bottom: 1px solid;
        }

        table .empty {
            height: 15px;
        }

        table tr th.value {
            font-weight: normal;
            font-size: 16px;
            text-align: left;
        }

        table td.line-number {
            text-align: right;
        }

    </style>

</head>
<body>
<div class="mission__container">

    <div style="margin-bottom: 5px">
        <h1>FEUILLE DE MISSION : FICHE FACTURATION</h1>
    </div>

    <table class="table table-striped table-bordered table-hover creation"
           cellpadding="0" cellspacing="0" border="0" width="100%">
        <thead>
        <tr>
            <th colspan="10" style="width: 100%;" class="text-center">CREATION</th>
        </tr>
        <tr>
            <th colspan="2" style="width: 20%;" class="text-center">Nom client</th>
            <th colspan="8" style="width: 80%;" class="value">{{ quoteRequest.businessName }}</th>
        </tr>
        <tr>
            <th colspan="1" style="width: 10%;" class="text-center">Commercial</th>
            <th colspan="1" style="width: 10%;"
                class="value">{% if quoteRequest.userInCharge %}{{ quoteRequest.userInCharge.firstName }} {{ quoteRequest.userInCharge.lastName }}{% endif %}
            </th>
            <th colspan="1" style="width: 10%;" class="text-center">Assistante</th>
            <th colspan="1" style="width: 10%;"
                class="value">{% if missionSheet.secondUserInCharge %}{{ missionSheet.secondUserInCharge.firstName }} {{ missionSheet.secondUserInCharge.lastName }}{% endif %}</th>
            <th colspan="1" style="width: 10%;" class="text-center">N° mnemonique</th>
            <th colspan="1" style="width: 10%;" class="value">{{ missionSheet.mnemonicNumber }}</th>
            <th colspan="1" style="width: 10%;" class="text-center">N° de site(s)</th>
            <th colspan="3" style="width: 30%;" class="value">{{ missionSheet.orderNumber }}</th>
        </tr>
        <tr>
            <th colspan="1" style="width: 10%;" class="text-center">Type de contrat</th>
            <th colspan="6" style="width: 60%;"
                class="value"> {% if quoteRequest.catalog == 'REGULAR' %}
                    {{ ('Commercial.MissionSheet.ContractType.'~missionSheet.contractType)|trans }}
                    (Contractuel)
                {% else %}
                    {{ ('Commercial.MissionSheet.ContractType.'~missionSheet.contractType)|trans }}
                    ({{ ('Commercial.QuoteRequest.'~quoteRequest.catalog)|trans }}){% endif %}
            </th>
            {#            <th colspan="1" style="width: 10%;" class="text-center">N° de commande</th> #}
            {#            <th colspan="2" style="width: 20%;" class="value">{{ missionSheet.orderNumber }}</th> #}
            <th colspan="1" style="width: 10%;" class="text-center">Factu</th>
            <th colspan="2" style="width: 20%;"
                class="value">{{ ('Commercial.MissionSheet.BillingType.'~missionSheet.billingType)|trans }}</th>
        </tr>
        <tr>
            <th colspan="1" style="width: 10%;" class="text-center">Date FM</th>
            <th colspan="3" style="width: 30%;"
                class="value">{{ date|localizeddate('short', 'none', app.request.locale, app.user.timezone) }}</th>
            <th colspan="1" style="width: 10%;" class="text-center">Date debut contrat</th>
            <th colspan="2" style="width: 20%;"
                class="value">{% if quoteRequest.startDate %}{{ quoteRequest.startDate|localizeddate('short', 'none', app.request.locale, app.user.timezone) }}{% endif %}</th>
            <th colspan="1" style="width: 10%;" class="text-center">Date fin contrat</th>
            <th colspan="2" style="width: 20%;"
                class="value">{% if quoteRequest.serviceEndDate %}{{ quoteRequest.serviceEndDate|localizeddate('short', 'none', app.request.locale, app.user.timezone) }}{% endif %}</th>
        </tr>
        <tr>
            <th colspan="1" style="width: 10%;" class="text-center">MyPaprec</th>
            <th colspan="1" style="width: 10%;"
                class="value">{% if missionSheet.myPaprecAccess == '0' %}Non{% else %}Oui{% endif %}</th>
            <th colspan="1" style="width: 10%;" class="text-center">Registre</th>
            <th colspan="1" style="width: 10%;"
                class="value">{% if missionSheet.wasteTrackingRegisterAccess == '0' %}Non{% else %}Oui{% endif %}</th>
            <th colspan="1" style="width: 10%;" class="text-center">Reporting</th>
            <th colspan="1" style="width: 10%;"
                class="value">{% if missionSheet.reportingAccess == '0' %}Non{% else %}Oui{% endif %}</th>
            <th colspan="1" style="width: 10%;" class="text-center">Mail</th>
            <th colspan="3" style="width: 30%;" class="value">{{ quoteRequest.email }}</th>
        </tr>
        <tr>
            <th colspan="10" style="width: 100%;" class="text-center">Commentaires et imperatifs de facturation</th>
        </tr>
        <tr>
            <th colspan="10" style="width: 100%;" class="value">{{ missionSheet.comment }}</th>
        </tr>
        </thead>
    </table>

    <table class="table table-striped table-bordered table-hover"
           cellpadding="0" cellspacing="0" border="0" width="100%">
        <thead>
        <tr>
            <th colspan="11" style="width: 100%;" class="text-center">Prestations facturees</th>
        </tr>
        <tr>
            <th class="text-center">{{ 'Commercial.QuoteRequestLine.ProductCode'|trans }}</th>
            <th class="text-center">{{ 'Commercial.QuoteRequestLine.ProductRange'|trans }}</th>
            <th class="text-center">{{ 'Commercial.QuoteRequestLine.ProductName'|trans }}</th>
            <th class="text-center">{{ 'Commercial.QuoteRequestLine.ProductBillingUnit'|trans }}</th>
            <th class="text-center">{{ 'Commercial.QuoteRequestLine.PDF.Quantity'|trans }}</th>
            <th class="text-center">{{ 'Commercial.QuoteRequestLine.PDF.PassingFrequency'|trans }}</th>
            <th class="text-center">{{ 'Commercial.QuoteRequestLine.RentalPrice'|trans }}</th>
            <th class="text-center">{{ 'Commercial.QuoteRequestLine.TreatmentCollect'|trans }}</th>
            <th class="text-center">{{ 'Commercial.QuoteRequestLine.Treatment'|trans }}</th>
            <th class="text-center">{{ 'Commercial.QuoteRequestLine.Exploitation'|trans }}</th>
            <th class="text-center">{{ 'Commercial.QuoteRequestLine.Package'|trans }}</th>
        </tr>
        </thead>
        <tbody>
        {% if quoteRequestLines|length > 0 %}
            {% for quoteRequestLine in quoteRequestLines %}
                <tr>
                    <td>
                        {{ quoteRequestLine.product.code }}
                    </td>
                    <td>
                        {% if quoteRequestLine.product.range %}
                            {{ quoteRequestLine.product.range|rangeLabelTranslation(app.user.lang) }}
                        {% endif %}
                    </td>
                    <td>
                        {{ quoteRequestLine.product|productLabelTranslation(app.user.lang) }}
                    </td>
                    <td>
                        {% if quoteRequestLine.product.billingUnit %}
                            {{ quoteRequestLine.product.billingUnit.name }}
                        {% endif %}
                    </td>
                    <td class="line-number">
                        {% if quoteRequestLine.product.calculationFormula == 'PACKAGE' %}
                            {{ quoteRequestLine.quantity }}
                        {% elseif quoteRequestLine.product.calculationFormula == 'UNIT_PRICE' %}
                            {# RESTE NULL #}
                        {% else %}
                            {{ quoteRequestLine.quantity }}
                        {% endif %}
                    </td>
                    <td>
                        {% if quoteRequestLine.product.hideFrequency == 1 %}

                        {% else %}
                            {% if quoteRequestLine.frequency != 'REGULAR' %}
                                {% if quoteRequestLine.frequency %}
                                    {{ ('Commercial.QuoteRequestLine.Frequency-values.'~quoteRequestLine.frequency)|trans({}, "messages", app.request.locale) }}
                                {% endif %}
                            {% else %}
                                {% if quoteRequestLine.frequencyInterval is not empty %}
                                    {% set frequencyIntervalName = 'General.Frequency.' ~ quoteRequestLine.frequencyInterval %}
                                    {{ quoteRequestLine.frequencyTimes }}
                                    x/ {{ frequencyIntervalName|trans({}, "messages", app.request.locale) }}
                                {% endif %}
                            {% endif %}
                        {% endif %}
                    </td>
                    <td class="line-number">
                        {% if quoteRequestLine.product.calculationFormula == 'PACKAGE' %}
                            {# RESTE NULL #}
                        {% elseif quoteRequestLine.product.calculationFormula == 'UNIT_PRICE' %}
                            {{ (quoteRequestLine|quoteRequestLineCalculatePrices('editableRentalUnitPrice'))|formatAmount('EUR', app.request.locale) }}
                        {% else %}
                            {{ (quoteRequestLine|quoteRequestLineCalculatePrices('editableRentalUnitPrice'))|formatAmount('EUR', app.request.locale) }}
                        {% endif %}
                    </td>
                    <td class="line-number">
                        {% if quoteRequestLine.product.calculationFormula == 'PACKAGE' %}
                            {# RESTE NULL #}
                        {% elseif quoteRequestLine.product.calculationFormula == 'UNIT_PRICE' %}
                            {{ (quoteRequestLine|quoteRequestLineCalculatePrices('treatmentCollectPrice'))|formatAmount('EUR', app.request.locale) }}
                        {% else %}
                            {{ (quoteRequestLine|quoteRequestLineCalculatePrices('treatmentCollectPrice'))|formatAmount('EUR', app.request.locale) }}
                        {% endif %}
                    </td>
                    <td class="line-number">
                        {% if quoteRequestLine.editableTreatmentUnitPrice < 0 %}
                            <i class="fas fa-exclamation-triangle" data-toggle="tooltip"
                               data-placement="top"
                               title="Le prix sera indexé mensuellement à la variation de la mercuriale Mercuriale choisie, référence Mois et Année de Référence"></i>
                        {% endif %}
                        {% if quoteRequestLine.product.calculationFormula == 'PACKAGE' %}
                            {# RESTE NULL #}
                        {% elseif quoteRequestLine.product.calculationFormula == 'UNIT_PRICE' %}
                            {{ (quoteRequestLine|quoteRequestLineCalculatePrices('editableTreatmentUnitPrice'))|formatAmount('EUR', app.request.locale) }}
                        {% else %}
                            {{ (quoteRequestLine|quoteRequestLineCalculatePrices('editableTreatmentUnitPrice'))|formatAmount('EUR', app.request.locale) }}
                        {% endif %}
                    </td>
                    <td>{% if quoteRequestLine.agency %}{{ quoteRequestLine.agency.name }}{% endif %}</td>
                    <td class="line-number">
                        {% if quoteRequestLine.product.calculationFormula == 'PACKAGE' or quoteRequestLine.product.catalog == 'MATERIAL' %}
                            {{ (quoteRequestLine|quoteRequestLineCalculatePrices('totalAmount'))|formatAmount('EUR', app.request.locale) }}
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        {% endif %}
        </tbody>
    </table>

    {% if quoteRequest.managementFeeCode1 is not empty or quoteRequest.managementFeeDescription1 is not empty or quoteRequest.managementFeeFrequency1 is not empty or (quoteRequest.managementFeeAmount1 is not null and quoteRequest.managementFeeAmount1 >= 0) or quoteRequest.managementFeeCode2 is not empty or quoteRequest.managementFeeDescription2 is not empty or quoteRequest.managementFeeFrequency2 is not empty or (quoteRequest.managementFeeAmount2 is not null and quoteRequest.managementFeeAmount2 >= 0) or quoteRequest.managementFeeCode3 is not empty or quoteRequest.managementFeeDescription3 is not empty or quoteRequest.managementFeeFrequency3 is not empty or (quoteRequest.managementFeeAmount3 is not null and quoteRequest.managementFeeAmount3 >= 0) or quoteRequest.managementFeeCode4 is not empty or quoteRequest.managementFeeDescription4 is not empty or quoteRequest.managementFeeFrequency4 is not empty or (quoteRequest.managementFeeAmount4 is not null and quoteRequest.managementFeeAmount4 >= 0) %}
        <table class="table table-striped table-bordered table-hover"
               cellpadding="0" cellspacing="0" border="0" width="100%">
            <thead>
            <tr>
                <th colspan="10" style="width: 100%;" class="text-center">Autres facturations</th>
            </tr>
            <tr>
                <th class="text-center">Code</th>
                <th class="text-center">Description</th>
                <th class="text-center">Fréquence</th>
                <th class="text-center">Montant</th>
            </tr>
            </thead>
            <tbody>
            {% if quoteRequest.managementFeeCode1 is not empty or quoteRequest.managementFeeDescription1 is not empty or quoteRequest.managementFeeFrequency1 is not empty or (quoteRequest.managementFeeAmount1 is not null and quoteRequest.managementFeeAmount1 >= 0) %}
                <tr>
                    <td>{{ quoteRequest.managementFeeCode1 }}</td>
                    <td>{{ quoteRequest.managementFeeDescription1 }}</td>
                    <td>{% if quoteRequest.managementFeeFrequency1 %}{{ ('General.Frequency.' ~ quoteRequest.managementFeeFrequency1)|trans({}, "messages", app.request.locale) }}{% endif %}</td>
                    <td class="line-number">{{ quoteRequest.managementFeeAmount1|formatAmount('EUR', app.request.locale) }}</td>
                </tr>
            {% endif %}
            {% if quoteRequest.managementFeeCode2 is not empty or quoteRequest.managementFeeDescription2 is not empty or quoteRequest.managementFeeFrequency2 is not empty or (quoteRequest.managementFeeAmount2 is not null and quoteRequest.managementFeeAmount2 >= 0) %}
                <tr>
                    <td>{{ quoteRequest.managementFeeCode2 }}</td>
                    <td>{{ quoteRequest.managementFeeDescription2 }}</td>
                    <td>{% if quoteRequest.managementFeeFrequency2 %}{{ ('General.Frequency.' ~ quoteRequest.managementFeeFrequency2)|trans({}, "messages", app.request.locale) }}{% endif %}</td>
                    <td class="line-number">{{ quoteRequest.managementFeeAmount2|formatAmount('EUR', app.request.locale) }}</td>
                </tr>
            {% endif %}
            {% if quoteRequest.managementFeeCode3 is not empty or quoteRequest.managementFeeDescription3 is not empty or quoteRequest.managementFeeFrequency3 is not empty or (quoteRequest.managementFeeAmount3 is not null and quoteRequest.managementFeeAmount3 >= 0) %}
                <tr>
                    <td>{{ quoteRequest.managementFeeCode3 }}</td>
                    <td>{{ quoteRequest.managementFeeDescription3 }}</td>
                    <td>{% if quoteRequest.managementFeeFrequency3 %}{{ ('General.Frequency.' ~ quoteRequest.managementFeeFrequency3)|trans({}, "messages", app.request.locale) }}{% endif %}</td>
                    <td class="line-number">{{ quoteRequest.managementFeeAmount3|formatAmount('EUR', app.request.locale) }}</td>
                </tr>
            {% endif %}
            {% if quoteRequest.managementFeeCode4 is not empty or quoteRequest.managementFeeDescription4 is not empty or quoteRequest.managementFeeFrequency4 is not empty or (quoteRequest.managementFeeAmount4 is not null and quoteRequest.managementFeeAmount4 >= 0) %}
                <tr>
                    <td>{{ quoteRequest.managementFeeCode4 }}</td>
                    <td>{{ quoteRequest.managementFeeDescription4 }}</td>
                    <td>{% if quoteRequest.managementFeeFrequency4 %}{{ ('General.Frequency.' ~ quoteRequest.managementFeeFrequency4)|trans({}, "messages", app.request.locale) }}{% endif %}</td>
                    <td class="line-number">{{ quoteRequest.managementFeeAmount4|formatAmount('EUR', app.request.locale) }}</td>
                </tr>
            {% endif %}
            </tbody>
        </table>
    {% endif %}
</div>

</body>
</html>
